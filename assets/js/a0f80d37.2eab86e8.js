"use strict";(self.webpackChunkpabpereza=self.webpackChunkpabpereza||[]).push([[3108],{1840:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>t,toc:()=>i});var a=s(17624),c=s(4552);const r={},o=void 0,t={id:"notas/Kubernetes/namespaces",title:"namespaces",description:"Namespaces",source:"@site/docs/notas/Kubernetes/namespaces.md",sourceDirName:"notas/Kubernetes",slug:"/notas/Kubernetes/namespaces",permalink:"/docs/notas/Kubernetes/namespaces",draft:!1,unlisted:!1,editUrl:"https://github.com/pabpereza/pabpereza/tree/main/docs/notas/Kubernetes/namespaces.md",tags:[],version:"current",frontMatter:{},sidebar:"notas",previous:{title:"mantenimiento",permalink:"/docs/notas/Kubernetes/mantenimiento"},next:{title:"pods",permalink:"/docs/notas/Kubernetes/pods"}},l={},i=[{value:"Namespaces",id:"namespaces",level:2},{value:"Listar namespaces",id:"listar-namespaces",level:3},{value:"Crear un namespace",id:"crear-un-namespace",level:3},{value:"Borrar un namespace",id:"borrar-un-namespace",level:2},{value:"Cambiar de namespace y contextos",id:"cambiar-de-namespace-y-contextos",level:3},{value:"Context",id:"context",level:2},{value:"Definir usuario",id:"definir-usuario",level:3},{value:"Definir un cluster",id:"definir-un-cluster",level:3}];function d(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.M)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"namespaces",children:"Namespaces"}),"\n",(0,a.jsx)(n.p,{children:"Los namespaces son una forma de agrupar y aislar los recursos de kubernetes. Esto permite que podamos segregar los diferentes recursos de una aplicaci\xf3n ( pod, deployment, service, etc) para establecer unas cuotas recursos, pol\xedticas de seguridad y configuraciones espec\xedficas."}),"\n",(0,a.jsxs)(n.p,{children:["Por omisi\xf3n, kubernetes crea un namespace llamado ",(0,a.jsx)(n.code,{children:"default"})," que es el namespace por defecto."]}),"\n",(0,a.jsx)(n.h3,{id:"listar-namespaces",children:"Listar namespaces"}),"\n",(0,a.jsx)(n.p,{children:"Podemos listar los namespaces con el comando:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl get ns\n"})}),"\n",(0,a.jsx)(n.p,{children:"Esto nos muestra nuestro namespace por defecto y los namespaces del sistema de kubernetes (no tocar estos namespaces):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"NAME              STATUS   AGE\ndefault           Active   26d\nkube-node-lease   Active   26d\nkube-public       Active   26d\nkube-system       Active   26d\n"})}),"\n",(0,a.jsx)(n.p,{children:"Puede ser interesante listar los namespaces junto con sus `labels``:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl get ns --show-labels\n"})}),"\n",(0,a.jsx)(n.p,{children:"Este comando nos muestra nuestros namespaces de la siguiente forma:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"NAME              STATUS   AGE   LABELS\ndefault           Active   26d   kubernetes.io/metadata.name=default\nkube-node-lease   Active   26d   kubernetes.io/metadata.name=kube-node-lease\nkube-public       Active   26d   kubernetes.io/metadata.name=kube-public\nkube-system       Active   26d   kubernetes.io/metadata.name=kube-system\n"})}),"\n",(0,a.jsx)(n.h3,{id:"crear-un-namespace",children:"Crear un namespace"}),"\n",(0,a.jsx)(n.p,{children:"Podemos crear un namespace simplemente con el comando:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl create ns <nombre-namespace>\n"})}),"\n",(0,a.jsx)(n.p,{children:"A\xfan as\xed, tambi\xe9n tambi\xe9n lo podemos crear con un fichero de configuraci\xf3n (este en formato json) para dejarlo definido como c\xf3digo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "apiVersion": "v1",\n  "kind": "Namespace",\n  "metadata": {\n    "name": "development",\n    "labels": {\n      "name": "development"\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Para utilizar este json de configuraci\xf3n podemos utilizar el comando:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl create -f <fichero-json>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"borrar-un-namespace",children:"Borrar un namespace"}),"\n",(0,a.jsx)(n.p,{children:"Podemos borrar un namespace con el comando:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl delete ns <nombre-namespace>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"cambiar-de-namespace-y-contextos",children:"Cambiar de namespace y contextos"}),"\n",(0,a.jsxs)(n.p,{children:["Podr\xedamos ejecutar comandos en cualquier namespace a\xf1adiendo el par\xe1mentro ",(0,a.jsx)(n.code,{children:"--namespace"})," o ",(0,a.jsx)(n.code,{children:"-n"})," a cualquier comando, por ejemplo:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl get pods --namespace development\n"})}),"\n",(0,a.jsx)(n.p,{children:"El proceso anterior ser\xeda m\xe1s farragoso, excepto que queramos lanzar un comando puntual en un namespace concreto, es m\xe1s recomendable utilizar la configuraci\xf3n de contexto de kubectl:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl config set-context <nombre-context> --namespace=<nombre-namespace>\n"})}),"\n",(0,a.jsx)(n.p,{children:"As\xed estar\xedamos asociando un namespace a un contexto."}),"\n",(0,a.jsx)(n.h2,{id:"context",children:"Context"}),"\n",(0,a.jsx)(n.p,{children:"Los contextos en kubernetes permiten definir a nuestro cliente diferentes entornos a los que conectarse. Estos entornos puedes ser namespaces o clusters diferentes."}),"\n",(0,a.jsx)(n.p,{children:"Podemos ver nuestra configuraci\xf3n con el comando:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl config view\n"})}),"\n",(0,a.jsx)(n.p,{children:"Esto nos mostrar\xe1 nuestra configuraci\xf3n de organizada de la siguiente manera:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Config\npreferences: {}\n\nclusters:\n- cluster:\n  name: development\n- cluster:\n  name: scratch\n\nusers:\n- name: developer\n- name: experimenter\n\ncontexts:\n- context:\n  name: dev-frontend\n  user: developer\n  cluster: development\n- context:\n    cluster: scratch\n    namespace: develop\n    user: experimenter\n  name: scratch-frontend\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Podemos distinguir tres elementros de la configuraci\xf3n:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Clusters: definen los clusters a los que podemos conectarnos."}),"\n",(0,a.jsx)(n.li,{children:"Users: definen los usuarios que podemos utilizar para conectarnos a los clusters."}),"\n",(0,a.jsx)(n.li,{children:"Contexts: definen los contextos a los que podemos conectarnos. Estos contextos guardan la relaci\xf3n de usuario, cluster y namespace."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Esta organizaci\xf3n nos permite definir clusters y usuarios individualmente y luego ir asoci\xe1ndolos en contexto concretos."}),"\n",(0,a.jsxs)(n.p,{children:["Este fichero de configuraci\xf3n se suele alojar en el directorio ",(0,a.jsx)(n.code,{children:"~/.kube/config"}),". Podemos a\xf1adir una nueva configuraci\xf3n editando el fichero o usando el comando:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl config set-context <nombre del contexto> --namespace=<nombre namespace OPCIONAL> \\\n  --cluster=<nombre del cluster> \\\n  --user=<usuario>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"definir-usuario",children:"Definir usuario"}),"\n",(0,a.jsx)(n.p,{children:"Se puede definir un usuario con el comando en nuestro fichero de configuraci\xf3n con el siguiente comando:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl config set-credentials <nombre-usuario> --client-certificate=<certificado> --client-key=<clave>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"definir-un-cluster",children:"Definir un cluster"}),"\n",(0,a.jsx)(n.p,{children:"Tambi\xe9n podemos definir por comandos clusters:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"kubectl config set-cluster <nombre-cluster> --server=<url del cluster> --certificate-authority=<certificado-autoridad>\n"})})]})}function u(e={}){const{wrapper:n}={...(0,c.M)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},4552:(e,n,s)=>{s.d(n,{I:()=>t,M:()=>o});var a=s(11504);const c={},r=a.createContext(c);function o(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);