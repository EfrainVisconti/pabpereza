"use strict";(self.webpackChunkpabpereza=self.webpackChunkpabpereza||[]).push([[9896],{67216:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>l});var s=o(17624),a=o(4552);const t={},i=void 0,r={id:"notas/Kubernetes/manifest",title:"manifest",description:"Por debajo de todas las acciones de kubernetes, lo que el motor entiende, son archivos manifiesto que definen el tipo de cada elemento.",source:"@site/docs/notas/Kubernetes/manifest.md",sourceDirName:"notas/Kubernetes",slug:"/notas/Kubernetes/manifest",permalink:"/docs/notas/Kubernetes/manifest",draft:!1,unlisted:!1,editUrl:"https://github.com/pabpereza/pabpereza/tree/main/docs/notas/Kubernetes/manifest.md",tags:[],version:"current",frontMatter:{},sidebar:"notas",previous:{title:"logging",permalink:"/docs/notas/Kubernetes/logging"},next:{title:"mantenimiento",permalink:"/docs/notas/Kubernetes/mantenimiento"}},d={},l=[{value:"Obtener el manifiesto de un pod",id:"obtener-el-manifiesto-de-un-pod",level:2},{value:"Definir un pod en un manifiesto",id:"definir-un-pod-en-un-manifiesto",level:2},{value:"Multiples contenedores en un pod",id:"multiples-contenedores-en-un-pod",level:2},{value:"Labels",id:"labels",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,a.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Por debajo de todas las acciones de kubernetes, lo que el motor entiende, son archivos manifiesto que definen el tipo de cada elemento."}),"\n",(0,s.jsx)(n.p,{children:"Cuando se coge cierta experiencia se dejan de usar comandos para usar manifiestos y poder aplicar varios a la vez, haciendo el proceso menos tedioso."}),"\n",(0,s.jsx)(n.h2,{id:"obtener-el-manifiesto-de-un-pod",children:"Obtener el manifiesto de un pod"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"kubectl get pods <nombre pod> -o <formato>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Existen varios formatos de salida pero los m\xe1s comunes son yaml (el usado nativamente por kubernetes), json,  name, go-template (para customizaciones)... ",(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/kubectl/overview/#custom-columns",children:"https://kubernetes.io/docs/reference/kubectl/overview/#custom-columns"})]}),"\n",(0,s.jsx)(n.h2,{id:"definir-un-pod-en-un-manifiesto",children:"Definir un pod en un manifiesto"}),"\n",(0,s.jsx)(n.p,{children:"Creamos la definici\xf3n de un pod de prueba que escribir\xe1 \u201cHello world\u201d cada hora:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"apiVersion: v1\nkind: Pod\nmetadata:\n  name: myapp-pod\n  labels:\n    app: myapp\nspec:\n  containers:\n  - name: myapp-container\n    image: busybox\n    command: ['sh', '-c', 'echo Hello World!; sleep 3600']\n"})}),"\n",(0,s.jsx)(n.p,{children:"Luego podr\xedamos crear el elemento con el comando:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f pods.yaml\n"})}),"\n",(0,s.jsx)(n.p,{children:"Tambi\xe9n podr\xedamos eliminarlo usando el manifiesto con el comando:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"kubectl deletec-f pods.yaml\n"})}),"\n",(0,s.jsx)(n.h2,{id:"multiples-contenedores-en-un-pod",children:"Multiples contenedores en un pod"}),"\n",(0,s.jsx)(n.p,{children:"Podemos definir varios contenedores en un pod. En este ejemplo podemos ver el balanceo que hace kubernetes a nivel de red entre los distintos contenedores de un pod."}),"\n",(0,s.jsx)("aside",{children:(0,s.jsx)(n.p,{children:"\ud83d\udce2 Importante no usar los mismos puertos en los contenedores o fallar\xe1"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Pod\nmetadata:\n  name: doscont\nspec:\n  containers:\n  - name: cont1\n    image: python:3.6-alpine\n    command: ['sh', '-c', 'echo \"cont1 > index.html\" && python -m http.server 8082']\n  - name: cont2\n    image: python:3.6-alpine\n    command: ['sh', '-c', 'echo \"cont2 > index.html\" && python -m http.server 8083']\n"})}),"\n",(0,s.jsx)(n.h2,{id:"labels",children:"Labels"}),"\n",(0,s.jsx)(n.p,{children:"Podemos usar etiquetas para filtrar recursos en proyectos de cierto tama\xf1o. Por ejemplo, separando frontend de backend:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Pod\nmetadata:\n  name: podtest2\n  labels:\n    app: front\n    env: dev\nspec:\n  containers:\n  - name: cont1\n    image: nginx:alpine\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},4552:(e,n,o)=>{o.d(n,{I:()=>r,M:()=>i});var s=o(11504);const a={},t=s.createContext(a);function i(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);