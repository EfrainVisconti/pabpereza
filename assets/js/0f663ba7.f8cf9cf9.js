"use strict";(self.webpackChunkpabpereza=self.webpackChunkpabpereza||[]).push([[8264],{24136:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>i,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>c});var a=n(17624),r=n(4552);const o={},l=void 0,t={id:"notas/Kubernetes/helm",title:"helm",description:"Helm es una herramienta que nos permite gestionar, versionar y desplegar m\xfaltiples recursos de kubernetes.",source:"@site/docs/notas/Kubernetes/helm.md",sourceDirName:"notas/Kubernetes",slug:"/notas/Kubernetes/helm",permalink:"/docs/notas/Kubernetes/helm",draft:!1,unlisted:!1,editUrl:"https://github.com/pabpereza/pabpereza/tree/main/docs/notas/Kubernetes/helm.md",tags:[],version:"current",frontMatter:{},sidebar:"notas",previous:{title:"deployments",permalink:"/docs/notas/Kubernetes/deployments"},next:{title:"ingress_controller",permalink:"/docs/notas/Kubernetes/ingress_controller"}},i={},c=[{value:"Repositorios",id:"repositorios",level:2},{value:"Desplegando un chart",id:"desplegando-un-chart",level:2}];function d(e){const s={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.M)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.p,{children:"Helm es una herramienta que nos permite gestionar, versionar y desplegar m\xfaltiples recursos de kubernetes."}),"\n",(0,a.jsx)(s.p,{children:"Los componentes en helm se estructuran de la siguiente manera:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-md",children:"\u251c\u2500\u2500 Chart.yaml\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 templates\n\u2502   \u251c\u2500\u2500 NOTES.txt\n\u2502   \u251c\u2500\u2500 _helpers.tpl\n\u2502   \u251c\u2500\u2500 configmap.yaml\n\u2502   \u251c\u2500\u2500 deployment.yaml\n\u2502   \u251c\u2500\u2500 pvc.yaml\n\u2502   \u251c\u2500\u2500 secrets.yaml\n\u2502   \u2514\u2500\u2500 svc.yaml\n\u2514\u2500\u2500 values.yaml\n"})}),"\n",(0,a.jsxs)(s.p,{children:["El fichero ",(0,a.jsx)(s.code,{children:"chart.yaml"})," contiene los metadatos del ",(0,a.jsx)(s.code,{children:"chart"}),", el ",(0,a.jsx)(s.code,{children:"values"})," contiene las claves y atributos a modificar y el templates contienen los manifiestos de kubernetes."]}),"\n",(0,a.jsx)(s.p,{children:"Las templates se generan como un recurso nombre de kubernetes solo que plantillando las variables para que el chart sirva a diferentes prop\xf3sitos y organizaciones. Por ejemplo:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-yml",children:'apiVersion: v1\nkind: Secret\nmetadata:\n    name: {{ template "fullname" . }}\n    labels:\n        app: {{ template "fullname" . }}\n        chart: "{{ .Chart.Name }}-{{ .Chart.Version }}"\n        release: "{{ .Release.Name }}"\n        heritage: "{{ .Release.Service }}"\ntype: Opaque\ndata:\n    mariadb-root-password: {{ default "" .Values.mariadbRootPassword | b64enc | quote }}\n    mariadb-password: {{ default "" .Values.mariadbPassword | b64enc | quote }}\n'})}),"\n",(0,a.jsx)(s.p,{children:"Este elemento de tipo secreto esta plantillado para que todos sus campos se recojan del fichero values. Esto nos permite, centralizar todos los valores en un \xfanico fichero (values.yaml) y por otra parte, permitir que nuestros elementos se kubernetes sean reutilizables."}),"\n",(0,a.jsxs)(s.p,{children:["Este conjunto de elementos se llama ",(0,a.jsx)(s.code,{children:"chart"})," y se pueden interactuar con ellos como repositorios de git."]}),"\n",(0,a.jsx)(s.h2,{id:"repositorios",children:"Repositorios"}),"\n",(0,a.jsxs)(s.p,{children:["Por defecto, helm busca ",(0,a.jsx)(s.code,{children:"charts"})," dentro de la web de ",(0,a.jsx)(s.a,{href:"https://artifacthub.io/",children:"Artifactory Hub"}),"."]}),"\n",(0,a.jsx)(s.p,{children:"Podr\xedamos buscar charts con el comando:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"helm search hub <nombre del chart> #Buscar repositorios\n\nhelm search repo <nomrbre del repositorio> #Buscar dentro del repositorio\n"})}),"\n",(0,a.jsx)(s.p,{children:"Tambi\xe9n podr\xedamos a\xf1adir nuevos repositorios, por ejemplo, el de bitnami:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"helm repo add bitnami ht\u200ctps://charts.bitnami.com/bitnami\n"})}),"\n",(0,a.jsx)(s.p,{children:"Los repositorios que trae por defecto y los que a\xf1adimos nosotros manualmente, pueden actualizarse con el comando:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"helm repo update\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Si ahora quisieramos buscar ",(0,a.jsx)(s.code,{children:"charts"})," solo dentro de este repositorio podr\xedamos hacerlo as\xed:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"helm search repo bitnami\n"})}),"\n",(0,a.jsx)(s.h2,{id:"desplegando-un-chart",children:"Desplegando un chart"}),"\n",(0,a.jsxs)(s.p,{children:["Podr\xedamos desplegar un ",(0,a.jsx)(s.code,{children:"chart"})," con el comando ",(0,a.jsx)(s.code,{children:"helm install"}),"  pero la mayor\xeda de ellos necesitan una personalizaci\xf3n para que funcionen correctamente por lo que primero debemos descargarlos en local para leer su README y modificar los valores pertinentes."]}),"\n",(0,a.jsx)(s.p,{children:"Esto lo podr\xedamos hacer con el comando:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"helm fetch <nombre repositorio> --untar\n"})}),"\n",(0,a.jsx)(s.p,{children:"Tras modificar todo lo que nos resultara necesario, podemos lanzar el siguiente comando en la ruta del repositorio:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"helm install <nombre del despliegue>\n"})}),"\n",(0,a.jsx)(s.p,{children:"Podr\xedamos desinstalarlo con el comando:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"helm uninstall <nombre del despliegue>\n"})}),"\n",(0,a.jsx)(s.p,{children:"Tambi\xe9n podr\xedamos listar todos los charts desplegados y sus respectivas versiones con el comando:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-helm",children:"helm list\n"})})]})}function p(e={}){const{wrapper:s}={...(0,r.M)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},4552:(e,s,n)=>{n.d(s,{I:()=>t,M:()=>l});var a=n(11504);const r={},o=a.createContext(r);function l(e){const s=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),a.createElement(o.Provider,{value:s},e.children)}}}]);