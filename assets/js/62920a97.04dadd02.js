"use strict";(self.webpackChunkpabpereza=self.webpackChunkpabpereza||[]).push([[5432],{32227:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>c,toc:()=>d});var a=o(17624),r=o(4552);const s={},i=void 0,c={id:"notas/nfs",title:"nfs",description:"El servicio de NFS es un servicio de red que nos permite compartir archivos entre distintos equipos. Este funciona de forma similar a una carpeta compartida en Windows.",source:"@site/docs/notas/nfs.md",sourceDirName:"notas",slug:"/notas/nfs",permalink:"/docs/notas/nfs",draft:!1,unlisted:!1,editUrl:"https://github.com/pabpereza/pabpereza/tree/main/docs/notas/nfs.md",tags:[],version:"current",frontMatter:{},sidebar:"notas",previous:{title:"index_lock",permalink:"/docs/notas/index_lock"},next:{title:"nmap",permalink:"/docs/notas/nmap"}},l={},d=[{value:"Servidor",id:"servidor",level:2},{value:"Instalaci\xf3n de los requisitos",id:"instalaci\xf3n-de-los-requisitos",level:3},{value:"Preparando la carpeta a compartir",id:"preparando-la-carpeta-a-compartir",level:3},{value:"Configurando el servidor",id:"configurando-el-servidor",level:3},{value:"Permitir conexiones remotas en el firewall",id:"permitir-conexiones-remotas-en-el-firewall",level:3},{value:"Cliente",id:"cliente",level:2},{value:"Instalaci\xf3n de los requisitos",id:"instalaci\xf3n-de-los-requisitos-1",level:3},{value:"Punto de montaje o carpeta donde montar los archivos remotos",id:"punto-de-montaje-o-carpeta-donde-montar-los-archivos-remotos",level:3},{value:"Montaje autom\xe1tico en el arranque - Fstab",id:"montaje-autom\xe1tico-en-el-arranque---fstab",level:3}];function t(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.M)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"El servicio de NFS es un servicio de red que nos permite compartir archivos entre distintos equipos. Este funciona de forma similar a una carpeta compartida en Windows.\nEsta pensado para funcionar como servidor o cliente. El servidor comparte una carpeta con uno o m\xe1s clientes y los clientes acceden a los archivos de la carpeta ( montando las carpetas en su sistema de ficheros )."}),"\n",(0,a.jsx)(n.p,{children:"Esta gu\xeda se parte por un lado en la configuraci\xf3n de un servidor NFS y por otro en la configuraci\xf3n de un cliente NFS."}),"\n",(0,a.jsx)(n.h2,{id:"servidor",children:"Servidor"}),"\n",(0,a.jsx)(n.h3,{id:"instalaci\xf3n-de-los-requisitos",children:"Instalaci\xf3n de los requisitos"}),"\n",(0,a.jsx)(n.p,{children:"Para funcionar NFS sobre el servidor debemos instalar los siguientes paquetes:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"apt install nfs-kernel-server nfs-common\n"})}),"\n",(0,a.jsx)(n.p,{children:"Con esto ya podemos para a la configuraci\xf3n."}),"\n",(0,a.jsx)(n.h3,{id:"preparando-la-carpeta-a-compartir",children:"Preparando la carpeta a compartir"}),"\n",(0,a.jsx)(n.p,{children:"Primero tenemos que crear la carpeta que vamos a compartir (en el caso de que ya la tengas puedes omitir este paso):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"mkdir <carpeta_compartida>\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Luego tenemos que asignar un propietario especial a esta carpeta.\nEste usuario ",(0,a.jsx)(n.code,{children:"nobody"})," y grupo ",(0,a.jsx)(n.code,{children:"nogroup"})," se utilizan para que los clientes remotos puedan acceder a los archivos de la carpeta compartida."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"chown nobody:nogroup <carpeta_compartida>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"configurando-el-servidor",children:"Configurando el servidor"}),"\n",(0,a.jsxs)(n.p,{children:["Para configurar el servidor NFS, debemos modificar el archivo de configuraci\xf3n ",(0,a.jsx)(n.code,{children:"/etc/exports"}),". Al final del fichero de configuraci\xf3n debemos a\xf1adir la siguiente l\xednea:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"/ruta/carpeta/compartida <origenes permitidos>(<opciones>)\n\n# Ejemplo, los or\xedgenes son todos los clientes, especificado con *.\n/home/usuario/carpeta_compartida *(rw,sync,no_subtree_check,no_root_squash)\n\n# Pod\xedamos especificar m\xfaltiples clientes con distintas opciones por cada uno de ellos\n/ruta/carpeta/compartida 192.168.1.56(rw,sync) 192.168.1.68(rw,sync)\n"})}),"\n",(0,a.jsx)(n.p,{children:"Podemos especificar los origenes permitidos al servidor de las siguientes maneras:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Host \xfanico: podr\xedamos especificar una IP o un nombre de host \xfanico como origen y repetir las opciones por cada uno de ellos."}),"\n",(0,a.jsxs)(n.li,{children:["Redes de IPs: Podr\xedamos especificar rangos de IPs especificando la IP con m\xe1scara de red. Ejemplo, ",(0,a.jsx)(n.code,{children:"192.168.1.0/24"})," permitir\xeda todas las IPs de la red desde ",(0,a.jsx)(n.code,{children:"192.168.1.0"})," hasta ",(0,a.jsx)(n.code,{children:"192.168.1.255"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["Comodines: Podr\xedamos usar ",(0,a.jsx)(n.code,{children:"*"})," para indicar que todos los clientes est\xe1n permitidos y tambien se puede combinar con nombres de dominios. Por ejemplo, ",(0,a.jsx)(n.code,{children:"*.example.com"})," permitir\xeda todos los clientes que tengan con subdominio de ",(0,a.jsx)(n.code,{children:"example.com"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["Grupos de red: Se podr\xeda definir un grupo de equipos de red especific\xe1ndolo de la siguiente manera ",(0,a.jsx)(n.code,{children:"@grupo_de_red"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Veamos las diferentes opciones que podemos configurar por cada origen o grupo de or\xedgenes:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Permisos de lectura: ",(0,a.jsx)(n.code,{children:"rw"})," para lectura y escritura y  ",(0,a.jsx)(n.code,{children:"ro"})," para solo lectura."]}),"\n",(0,a.jsxs)(n.li,{children:["Opciones de sincronizaci\xf3n: ",(0,a.jsx)(n.code,{children:"sync"})," para sincronizar los archivos y ",(0,a.jsx)(n.code,{children:"async"})," para no sincronizar los archivos."]}),"\n",(0,a.jsxs)(n.li,{children:["Opciones de compartici\xf3n: ",(0,a.jsx)(n.code,{children:"no_subtree_check"})," para que no se compruebe el subdirectorio y ",(0,a.jsx)(n.code,{children:"no_root_squash"})," para que no se comparta el root."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Una vez configuradas las carpetas a compartir tendr\xedamos que reiniciar el servicio para que se aplique la nueva configuraci\xf3n."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"systemctl restart nfs-kernel-server\n"})}),"\n",(0,a.jsx)(n.h3,{id:"permitir-conexiones-remotas-en-el-firewall",children:"Permitir conexiones remotas en el firewall"}),"\n",(0,a.jsxs)(n.p,{children:["Para permitir conexiones remotas en el firewall debemos permitir conexiones al puerto ",(0,a.jsx)(n.code,{children:"2049"})," y ",(0,a.jsx)(n.code,{children:"111"})," que utiliza el servicio NFS. Con ",(0,a.jsx)(n.code,{children:"ufw"})," en ubuntu se puede hacer de la siguiente manera:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"# Permitir or\xedgenes espec\xedficos en el firewall\nufw allow from <origen> to any port nfs\n\n# Permitir todos los or\xedgenes en el firewall\nufw allow from any to any port nfs\n"})}),"\n",(0,a.jsx)(n.h2,{id:"cliente",children:"Cliente"}),"\n",(0,a.jsx)(n.h3,{id:"instalaci\xf3n-de-los-requisitos-1",children:"Instalaci\xf3n de los requisitos"}),"\n",(0,a.jsx)(n.p,{children:"Para funcionar NFS como cliente debemos instalar el siguiente paquete:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"apt install nfs-common\n"})}),"\n",(0,a.jsx)(n.h3,{id:"punto-de-montaje-o-carpeta-donde-montar-los-archivos-remotos",children:"Punto de montaje o carpeta donde montar los archivos remotos"}),"\n",(0,a.jsxs)(n.p,{children:["Debemos espesificar la carpeta donde vamos a montar los archivos remotos. Esto se puede hacer con el comando ",(0,a.jsx)(n.code,{children:"mount"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"mount <IP del servidor>:/ruta/carpeta/remota /ruta/carpeta/local \n"})}),"\n",(0,a.jsx)(n.p,{children:"Una vez montada la carpeta podemos listar todos los puntos de montaje del servidor con el siguiente comando:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"showmount -e <IP del servidor>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Tambi\xe9n podr\xedamos listar los montajes locales con el comando:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"df -h\n"})}),"\n",(0,a.jsx)(n.p,{children:"Por \xfaltimo, podr\xedamos desmontar un punto de montaje con el comando:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"umount /ruta/carpeta/local\n"})}),"\n",(0,a.jsx)(n.h3,{id:"montaje-autom\xe1tico-en-el-arranque---fstab",children:"Montaje autom\xe1tico en el arranque - Fstab"}),"\n",(0,a.jsxs)(n.p,{children:["Podemos montar autom\xe1ticamente la carpeta remota en el arranque a\xf1adiendo una l\xednea de configuraci\xf3n en el archivo ",(0,a.jsx)(n.code,{children:"/etc/fstab"}),":"]}),"\n",(0,a.jsx)(n.p,{children:"La l\xednea tendr\xeda el siguiente formato:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"<IP del servidor>:<ruta/carpeta/remota> /ruta/carpeta/local nfs <opciones> 0 0\n\n# Por ejemplo:\n192.168.1.56:/home/user/compartida /home/cliente/compartida nfs rw,nofail,noatime,nolock,intr,tcp,actimeo=1800 0 0\n"})}),"\n",(0,a.jsx)(n.p,{children:"Ahora podr\xedamos reiniciar el servidor y comprobar que la carpeta se ha montado autom\xe1ticamente. A veces tarda unos segundos/minutos en realizar el montaje."})]})}function p(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(t,{...e})}):t(e)}},4552:(e,n,o)=>{o.d(n,{I:()=>c,M:()=>i});var a=o(11504);const r={},s=a.createContext(r);function i(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);